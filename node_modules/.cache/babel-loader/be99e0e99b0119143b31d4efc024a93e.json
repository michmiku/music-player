{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\micha\\\\Desktop\\\\port\\\\portfolio\\\\portfolio\\\\src\\\\components\\\\Music.js\";\nimport React, { useState, useContext, useEffect, useRef } from \"react\";\nimport { AuthenticatedUser } from \"../contexts/AuthenticatedUser.js\";\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport Player from \"./Player.js\";\nimport Sidebar from \"./Sidebar.js\";\n\nconst Music = () => {\n  const [musicList, setMusicList] = useState({\n    music: []\n  });\n  const [src, setSrc] = useState('');\n  const [isPlaying, setIsPlaying] = useState({\n    playing: false\n  });\n  const [duration, setDuration] = useState();\n  const [currentTime, setCurrentTime] = useState();\n  const [currentId, setCurrentId] = useState();\n  const {\n    authUser,\n    setAuthUser\n  } = useContext(AuthenticatedUser);\n  const player = useRef(null);\n  useEffect(() => {\n    axios.get('http://localhost:5000/music/').then(res => {\n      setMusicList({\n        music: res.data\n      });\n      console.log(res.data);\n    }).catch(err => console.log(err));\n  }, []);\n  useEffect(() => {\n    if (src !== '') {\n      player.current.load();\n      player.current.play();\n    }\n  }, [src]);\n\n  const getDuration = function (url, next) {\n    var _player = new Audio(url);\n\n    _player.addEventListener(\"durationchange\", function (e) {\n      if (this.duration != Infinity) {\n        var duration = this.duration;\n\n        _player.remove();\n\n        next(duration);\n      }\n\n      ;\n    }, false);\n\n    _player.load();\n\n    _player.currentTime = 24 * 60 * 60;\n    _player.volume = 0;\n\n    _player.play();\n  };\n\n  const handleTitleClick = (file, key) => {\n    setSrc('http://localhost:5000/music/' + file);\n    setIsPlaying({\n      playing: true\n    });\n    setCurrentId(key);\n    getDuration('http://localhost:5000/music/' + file, function (duration) {\n      console.log(src);\n      setDuration(duration);\n    });\n  };\n\n  const handlePlay = (file, key) => {\n    if (src === '' && file === undefined) {} else if (src === 'http://localhost:5000/music/' + file || file === undefined) {\n      setIsPlaying({\n        playing: true\n      });\n      player.current.play();\n    } else {\n      setSrc('http://localhost:5000/music/' + file);\n      setIsPlaying({\n        playing: true\n      });\n      setCurrentId(key);\n      getDuration('http://localhost:5000/music/' + file, function (duration) {\n        setDuration(duration);\n      });\n    }\n  };\n\n  const handlePause = () => {\n    setIsPlaying({\n      playing: false\n    });\n    player.current.pause();\n  };\n\n  const handleProgress = () => {\n    setCurrentTime(player.current.currentTime);\n  };\n\n  const handleEnd = e => {\n    console.log('ended');\n    setSrc('');\n    setIsPlaying({\n      playing: false\n    });\n    setDuration('');\n    setCurrentTime('');\n    player.current.pause();\n    player.current.load();\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, authUser.username != '' ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cont\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Sidebar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"music-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"top-view\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    className: \"number\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 29\n    }\n  }, \"#\"), /*#__PURE__*/React.createElement(\"a\", {\n    className: \"title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 29\n    }\n  }, \"Title\"), /*#__PURE__*/React.createElement(\"a\", {\n    className: \"author\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 29\n    }\n  }, \"Artist\"), /*#__PURE__*/React.createElement(\"i\", {\n    className: \"far fa-clock time fa-lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 29\n    }\n  })), musicList.music.map(({\n    file,\n    title,\n    artist,\n    duration\n  }, key) => {\n    {\n      let minutes = Math.floor(duration / 60);\n      let seconds = Math.floor(duration - minutes * 60);\n\n      if (seconds < 10) {\n        seconds = '0' + seconds;\n      }\n\n      if (minutes < 10) {\n        minutes = '0' + minutes;\n      }\n\n      console.log('asd');\n    }\n\n    /*#__PURE__*/\n    React.createElement(\"div\", {\n      className: \"middle-view\",\n      key: key,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      className: \"number\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 37\n      }\n    }, key), /*#__PURE__*/React.createElement(\"a\", {\n      onClick: () => {\n        handleTitleClick(file, key);\n      },\n      className: \"title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 37\n      }\n    }, title), /*#__PURE__*/React.createElement(\"a\", {\n      className: \"author\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 37\n      }\n    }, artist), /*#__PURE__*/React.createElement(\"a\", {\n      className: \"time\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 37\n      }\n    }, duration), !(src === 'http://localhost:5000/music/' + file && isPlaying.playing) ? /*#__PURE__*/React.createElement(\"i\", {\n      onClick: () => {\n        handlePlay(file, key);\n      },\n      className: \"far fa-play-circle play-button-list fa-2x\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 41\n      }\n    }) : /*#__PURE__*/React.createElement(\"i\", {\n      onClick: () => {\n        handlePause();\n      },\n      className: \"far fa-pause-circle fa-2x play-button-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 41\n      }\n    }));\n  })), /*#__PURE__*/React.createElement(Player, {\n    isPlaying: isPlaying,\n    handlePlay: () => {\n      handlePlay();\n    },\n    handlePause: () => {\n      handlePause();\n    },\n    player: player,\n    src: src,\n    setSrc: setSrc,\n    duration: duration,\n    currentTime: currentTime,\n    musicList: musicList,\n    currentId: currentId,\n    setCurrentId: setCurrentId,\n    getDuration: getDuration,\n    setDuration: setDuration,\n    setIsPlaying: setIsPlaying,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"audio\", {\n    ref: player,\n    onTimeUpdate: () => handleProgress(),\n    onEnded: () => {\n      handleEnd();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"source\", {\n    src: src,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 25\n    }\n  }))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    className: \"card-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 21\n    }\n  }, \"You are not logged in!\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"card-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 21\n    }\n  }, \"In order to browse and listen to music you need to either login to your account or create a new one.\"), /*#__PURE__*/React.createElement(Link, {\n    to: \"/login\",\n    className: \"btn btn-primary mr-3 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 21\n    }\n  }, \"Login\"), /*#__PURE__*/React.createElement(Link, {\n    to: \"/register\",\n    className: \"btn btn-primary \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 21\n    }\n  }, \"Register\")));\n};\n\nexport default Music;","map":{"version":3,"sources":["C:/Users/micha/Desktop/port/portfolio/portfolio/src/components/Music.js"],"names":["React","useState","useContext","useEffect","useRef","AuthenticatedUser","Link","axios","Player","Sidebar","Music","musicList","setMusicList","music","src","setSrc","isPlaying","setIsPlaying","playing","duration","setDuration","currentTime","setCurrentTime","currentId","setCurrentId","authUser","setAuthUser","player","get","then","res","data","console","log","catch","err","current","load","play","getDuration","url","next","_player","Audio","addEventListener","e","Infinity","remove","volume","handleTitleClick","file","key","handlePlay","undefined","handlePause","pause","handleProgress","handleEnd","username","map","title","artist","minutes","Math","floor","seconds"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect, useRef } from \"react\";\r\nimport { AuthenticatedUser } from \"../contexts/AuthenticatedUser.js\"\r\nimport { Link } from 'react-router-dom'\r\nimport axios from 'axios'\r\nimport Player from \"./Player.js\";\r\nimport Sidebar from \"./Sidebar.js\";\r\n\r\nconst Music = () => {\r\n    const [musicList, setMusicList] = useState({ music: [] })\r\n    const [src, setSrc] = useState('')\r\n    const [isPlaying, setIsPlaying] = useState({ playing: false })\r\n    const [duration, setDuration] = useState()\r\n    const [currentTime, setCurrentTime] = useState()\r\n    const [currentId, setCurrentId] = useState()\r\n\r\n    const { authUser, setAuthUser } = useContext(AuthenticatedUser)\r\n\r\n    const player = useRef(null)\r\n\r\n    useEffect(() => {\r\n        axios.get('http://localhost:5000/music/')\r\n            .then(res => {\r\n                setMusicList({ music: res.data })\r\n                console.log(res.data)\r\n\r\n            })\r\n            .catch(err => console.log(err));\r\n    }, [])\r\n    useEffect(() => {\r\n        if (src !== '') {\r\n            player.current.load()\r\n            player.current.play()\r\n        }\r\n\r\n    }, [src])\r\n    const getDuration = function (url, next) {\r\n        var _player = new Audio(url);\r\n        _player.addEventListener(\"durationchange\", function (e) {\r\n            if (this.duration != Infinity) {\r\n                var duration = this.duration\r\n                _player.remove();\r\n                next(duration);\r\n            };\r\n        }, false);\r\n        _player.load();\r\n        _player.currentTime = 24 * 60 * 60;\r\n        _player.volume = 0;\r\n        _player.play();\r\n    };\r\n    const handleTitleClick = (file, key) => {\r\n        setSrc('http://localhost:5000/music/' + file)\r\n        setIsPlaying({ playing: true })\r\n        setCurrentId(key)\r\n        getDuration('http://localhost:5000/music/' + file, function (duration) {\r\n            console.log(src)\r\n            setDuration(duration)\r\n        });\r\n    }\r\n    const handlePlay = (file, key) => {\r\n        if (src === '' && file === undefined) {\r\n\r\n        }\r\n        else if ((src === 'http://localhost:5000/music/' + file) || file === undefined) {\r\n            setIsPlaying({ playing: true })\r\n            player.current.play()\r\n        }\r\n        else {\r\n            setSrc('http://localhost:5000/music/' + file)\r\n            setIsPlaying({ playing: true })\r\n            setCurrentId(key)\r\n            getDuration('http://localhost:5000/music/' + file, function (duration) {\r\n                setDuration(duration)\r\n            });\r\n        }\r\n    }\r\n    const handlePause = () => {\r\n        setIsPlaying({ playing: false })\r\n        player.current.pause()\r\n    }\r\n    const handleProgress = () => {\r\n        setCurrentTime(player.current.currentTime)\r\n    }\r\n    const handleEnd = (e) => {\r\n        console.log('ended')\r\n        setSrc('')\r\n        setIsPlaying({ playing: false })\r\n        setDuration('')\r\n        setCurrentTime('')\r\n        player.current.pause()\r\n        player.current.load()\r\n    }\r\n    return (\r\n        <div>\r\n            {authUser.username != '' ?\r\n                <div className=\"cont\">\r\n                    <Sidebar />\r\n                    <div className=\"music-container\">\r\n                        <div className=\"top-view\">\r\n                            <a className=\"number\">#</a>\r\n                            <a className=\"title\">Title</a>\r\n                            <a className=\"author\">Artist</a>\r\n                            <i className=\"far fa-clock time fa-lg\"></i>\r\n                        </div>\r\n                        {musicList.music.map(({ file, title, artist, duration }, key) => {\r\n                            {\r\n                                let minutes = Math.floor(duration / 60);\r\n                                let seconds = Math.floor(duration - minutes * 60);\r\n                                if (seconds < 10) {\r\n                                    seconds = '0' + seconds\r\n                                }\r\n                                if (minutes < 10) {\r\n                                    minutes = '0' + minutes\r\n                                }\r\n                                console.log('asd')\r\n                            }\r\n                            (\r\n\r\n                                <div className=\"middle-view\" key={key}>\r\n                                    <a className=\"number\">{key}</a>\r\n                                    <a onClick={() => { handleTitleClick(file, key) }} className=\"title\">{title}</a>\r\n                                    <a className=\"author\">{artist}</a>\r\n                                    <a className=\"time\">{duration}</a>\r\n                                    {!((src === 'http://localhost:5000/music/' + file) && (isPlaying.playing)) ?\r\n                                        <i onClick={() => { handlePlay(file, key) }} className=\"far fa-play-circle play-button-list fa-2x\"></i> :\r\n                                        <i onClick={() => { handlePause() }} className=\"far fa-pause-circle fa-2x play-button-list\"></i>\r\n                                    }\r\n                                </div>\r\n                            )\r\n                        })\r\n                        }\r\n                    </div>\r\n                    <Player isPlaying={isPlaying} handlePlay={() => { handlePlay() }} handlePause={() => { handlePause() }} player={player} src={src} setSrc={setSrc} duration={duration} currentTime={currentTime} musicList={musicList} currentId={currentId} setCurrentId={setCurrentId} getDuration={getDuration} setDuration={setDuration} setIsPlaying={setIsPlaying} />\r\n                    <audio ref={player} onTimeUpdate={() => handleProgress()} onEnded={() => { handleEnd() }}>\r\n                        <source src={src} />\r\n                    </audio>\r\n                </div>\r\n\r\n                :\r\n                <div className=\"card-body\">\r\n                    <h5 className=\"card-title\">You are not logged in!</h5>\r\n                    <p className=\"card-text\">In order to browse and listen to music you need to either login to your account or create a new one.</p>\r\n                    <Link to=\"/login\" className=\"btn btn-primary mr-3 \">Login</Link>\r\n                    <Link to=\"/register\" className=\"btn btn-primary \">Register</Link>\r\n                </div>\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Music;\r\n\r\n"]},"metadata":{},"sourceType":"module"}